# Homework 3

[TOC]

## Statement
I declare that the assignment submitted on Elearning system is original except for source material explicitly acknowledged, and that the same or related material has not been previously submitted for another course. I also acknowledge that I am aware of University policy and regulations on honesty in academic work, and of the disciplinary guidelines and procedures applicable to breaches of such policy and regulations, as contained in the website [https://www.cuhk.edu.hk/policy/academichonesty/](https://www.cuhk.edu.hk/policy/academichonesty/).

<div align=center style="font-size: 18px;">
    Name<u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</u><u>Your Name</u><u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</u>SID<u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</u><u>1155xxxxxx</u><u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</u><br/>Date<u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</u><u>19/11/2024</u><u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</u>Signature <u>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</u>
</div>



<div style="page-break-after: always;"></div>
## Q1 [20 marks]: Parameter Design for Minhash/ Locality Sensitive Hashing (LSH)

Let r be the number of rows within each band and B be the total number of bands within the Minhash signature matrix M (r and B are all positive integers). We want to design a system such that:

- For any pair of items with a similarity greater than or equal to T1, the probability that they will be correctly identified as a similar-pair candidate should be at least P1.
- For any pair of items with similarity below T2, the probability that they will be mistakenly identified as a similar-pair candidate should be no more than P2.

### a. [10 marks] 

- Let s be the similarity between items.
- Probability for pair to be correct recognized can be $$P(s)=1−(1−s^r)^B$$
- Thus
    - $$1 - (1 - T_1^r)^B \geq P_1$$
    - $$1 - (1 - T_2^r)^B \leq P_2$$

- Leads to 
    - $$B* log(1 - T_1^r) \leq log(1-P_1)$$
    - $$B* log(1 - T_2^r) \geq log(1-P_2)$$

###  b. [10 marks] 

- Given $$T1=0.9 , T2=0.2, P1=0.95, P2=0.03$$ that
    - $$\frac{log(1-0.95)}{log(1 - 0.9^r)} \leq B \leq \frac{log(1-0.03)}{log(1 - 0.2^r)}$$

- Also $$B = \frac{96}{r}$$, where $$B, r \in \mathbb{Z}^{+}$$

- In the graph that means B is on the red line and higher than green line but lower than blue line
    - <img src="https://cdn.jsdelivr.net/gh/MonsterXia/Piclibrary/Pic202411220058608.png"/>
    - (8, 12); (6, 16) meet the requirement

## Q2 [60 marks + 20 bonus]: K-means Clustering

### a.  [30 marks] 

Totally initialized randomly. As every digit for vector is belong to [0, 255]. Let every digit of it be a random number.

```java
package com.monsterxia;

import java.io.FileWriter;
import java.io.IOException;

public class RandomInit {
    public static void main(String[] args) {
        String fileName = "RandomInit";

        String resourcesPath = RandomInit.class.getClassLoader().getResource("train_img").getPath();
        String outputPath = resourcesPath.substring(0, resourcesPath.indexOf("/target/classes")) + "/src/main/resources/";
        fileName = outputPath + fileName;
        System.out.println(fileName);

        try {
            FileWriter fileWriter = new FileWriter(fileName);

            for (int i = 0; i < 10; i++){
                StringBuilder sb = new StringBuilder();
                for (int j = 0; j < 784; j++){
                    sb.append((int)(Math.random() * 256));
                    sb.append(",");
                }
                sb.deleteCharAt(sb.length()-1);
                fileWriter.write(sb + "\n");
                System.out.println(sb);
            }
            fileWriter.close();
        } catch (IOException e) {
            throw new RuntimeException(e);
        }
    }
}

```

For MapReduce

```java
package com.monsterxia;

import org.apache.hadoop.conf.Configuration;
import org.apache.hadoop.fs.FSDataInputStream;
import org.apache.hadoop.fs.FileSystem;
import org.apache.hadoop.fs.Path;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapreduce.Job;
import org.apache.hadoop.mapreduce.Mapper;
import org.apache.hadoop.mapreduce.Reducer;
import org.apache.hadoop.mapreduce.filecache.DistributedCache;
import org.apache.hadoop.mapreduce.lib.input.FileInputFormat;
import org.apache.hadoop.mapreduce.lib.output.FileOutputFormat;
import org.apache.hadoop.util.GenericOptionsParser;

import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.math.BigDecimal;
import java.math.BigInteger;
import java.util.Arrays;

public class KMeans {
    public static class KMeansMapper extends Mapper<Object, Text, Text, Text> {
        static BigInteger[][] average = new BigInteger[10][256];
        @Override
        protected void setup(Context context) throws IOException {
            // Get Cache from DistributedCache
            Path[] files = DistributedCache.getLocalCacheFiles(context.getConfiguration());
            for (Path file : files) {
                // Process the file as needed
                BufferedReader reader = new BufferedReader(new FileReader(file.toString()));
                String line;
                int i = 0;
                while ((line = reader.readLine()) != null) {
                    String[] pixels = line.split(",");
                    for (int j = 0; j < pixels.length; j++) {
                        average[i][j] = new BigInteger(pixels[j]);
                    }
                    i++;
                }
                reader.close();
            }
        }

        @Override
        public void map(Object key, Text value, Mapper.Context context) throws IOException, InterruptedException {
            int tag = closest(value.toString(), average);

            Text index = new Text(String.valueOf(tag));
            context.write(index, new Text(value.toString()));
        }

        public static int closest(String image, BigInteger[][] average) {
            BigInteger[] distance = new BigInteger[10];
            for (int i = 0; i < 10; i++) {
                distance[i] = new BigInteger("0");
            }

            String[] temp = image.split(",");
            for (int i = 0; i < temp.length; i++) {
                BigInteger test = new BigInteger(temp[i]);
                for (int j = 0; j < 10; j++) {
                    BigInteger temp2 = average[j][i].subtract(test).abs();
                    distance[j] = distance[j].add(
                            temp2.multiply(temp2)
                    );
                }
            }

            BigInteger min = distance[0];
            int minIndex = 0;
            for (int i = 1; i < distance.length; i++) {
                if (distance[i].compareTo(min) < 0) {
                    min = distance[i];
                    minIndex = i;
                }
            }

            return minIndex;
        }
    }

    public static class KMeansReducer extends Reducer<Text, Text, Text, Text> {
        public static final BigDecimal THRESHOLD = new BigDecimal("0.01");
        public static final int N = 4628551;
        @Override
        public void reduce(Text key, Iterable<Text> values, Context context) throws IOException, InterruptedException {
            BigInteger[] sum = new BigInteger[784];
            Arrays.fill(sum, new BigInteger("0"));

            int count = 0;
            for (Text value : values){
                String[] pixels = value.toString().split(",");
                for (int i = 0; i < pixels.length; i++) {
                    sum[i] = sum[i].add(new BigInteger(pixels[i]));
                }

                count++;
            }

            StringBuilder sb = new StringBuilder();
            for (int i = 0; i < 784; i++) {
                if (sum[i].compareTo(new BigInteger("0")) != 0) {
                    sum[i] = sum[i].divide(new BigInteger(String.valueOf(count)));
                }
                sb.append(sum[i]).append(",");
            }
            sb.deleteCharAt(sb.length()-1).append("\n");

            Text result = new Text(sb.toString());
            Text empty = new Text("");
            context.write(result, empty);
        }
    }

    public static void main(String[] args) throws IOException, InterruptedException, ClassNotFoundException {
        Configuration conf = new Configuration();
        String[] otherArgs = new GenericOptionsParser(conf, args).getRemainingArgs();
        if (otherArgs.length != 2) {
            System.err.println("Usage: KMeans <dataset> <out>");
            System.exit(2);
        }
        int rounds = 1;
        boolean stop = false;
        System.out.println("Round <>: D(curr, prev) = <>");
        while (!stop) {
            String[] prev = getCenter(new Path(otherArgs[1]));

            Job job = Job.getInstance(conf);
            job.setJarByClass(KMeans.class);

            job.setMapperClass(KMeansMapper.class);
            job.setReducerClass(KMeansReducer.class);

            job.setMapOutputKeyClass(Text.class);
            job.setMapOutputValueClass(Text.class);

            job.setOutputKeyClass(Text.class);
            job.setOutputValueClass(Text.class);

            FileInputFormat.addInputPath(job, new Path(otherArgs[0]));
            DistributedCache.addCacheFile(new Path(otherArgs[1]).toUri(), job.getConfiguration());
            FileOutputFormat.setOutputPath(job, new Path(otherArgs[1]));

            job.waitForCompletion(true);

            String[] curr = getCenter(new Path(otherArgs[1]));
            stop = isStop(prev, curr, rounds);
            rounds++;
        }

        System.exit(0);
    }

    static String[] getCenter(Path path) {
        String[] center = new String[10];
        Configuration conf = new Configuration();
        FileSystem fs = null;
        try {
            fs = FileSystem.get(conf);
            FSDataInputStream in = fs.open(path);
            BufferedReader reader = new BufferedReader(new InputStreamReader(in));
            String line;
            int index = 0;
            while ((line = reader.readLine()) != null) {
                center[index++] = line;
            }
            reader.close();
            in.close();
        } catch (IOException e) {
            e.printStackTrace();
        }

        return center;
    }

    static boolean isStop(String[] prev, String[] curr, int rounds) {
        double sum = 0;
        for (int i = 0; i < 10; i++) {
            String[] prevPixels = prev[i].split(",");
            String[] currPixels = curr[i].split(",");
            for (int j = 0; j < prevPixels.length; j++) {
                int temp = Integer.parseInt(prevPixels[j]) - Integer.parseInt(currPixels[j]);
                sum += Math.pow(temp, 2);
            }
        }
        sum = Math.sqrt(sum);

        System.out.println("Round " + rounds + ": D(curr, prev) = " + sum);
        if (sum < 0.05) {
            System.out.println("Achieve convergence at round = " + rounds);
            return true;
        }else {
            return false;
        }
    }
}

```

Download the dataset, upload the dataset, copy to HDFS, upload the code and Run by

```bash
cd /usr/local/hadoop/dataset
cd ../scripts
../sbin/start-dfs.sh
../sbin/start-yarn.sh
../bin/hdfs dfs -mkdir /user
../bin/hdfs dfs -mkdir /user/5709master
../bin/hdfs dfs -mkdir /user/5709master/dataset
../bin/hadoop fs -put /usr/local/hadoop/dataset/* hdfs://hadoop-namenode:54310/user/5709master/dataset
../bin/hadoop com.sun.tools.javac.Main KMeans.java
jar cf APriori.jar KMeans*.class
../bin/hadoop jar KMeans.jar KMeans ./dataset/train_img output1
```

During the program, for every rounds, D are shows below:

```sql
Round <>: D(curr, prev) = <>
Round 1: D(curr, prev) = 11536.404985956413
Round 2: D(curr, prev) = 1560.186847784585
Round 3: D(curr, prev) = 1082.929822287668
Round 4: D(curr, prev) = 615.5972709491166
Round 5: D(curr, prev) = 337.18837465132157
Round 6: D(curr, prev) = 261.27188903515815
Round 7: D(curr, prev) = 240.38510769180357
Round 8: D(curr, prev) = 234.12389882282415
Round 9: D(curr, prev) = 214.80456233516085
Round 10: D(curr, prev) = 184.75118402868222
Round 11: D(curr, prev) = 172.14238292762187
Round 12: D(curr, prev) = 157.31814898478814
Round 13: D(curr, prev) = 141.12051587207299
Round 14: D(curr, prev) = 118.67181636766162
Round 15: D(curr, prev) = 97.71386800244886
Round 16: D(curr, prev) = 82.12186067059123
Round 17: D(curr, prev) = 71.47726911403373
Round 18: D(curr, prev) = 53.52569476429054
Round 19: D(curr, prev) = 46.400431032480725
Round 20: D(curr, prev) = 37.33630940518894
Round 21: D(curr, prev) = 36.864617182333525
Round 22: D(curr, prev) = 33.34666400106613
Round 23: D(curr, prev) = 34.66987164671943
Round 24: D(curr, prev) = 33.090784215548595
Round 25: D(curr, prev) = 35.32704346531139
Round 26: D(curr, prev) = 38.8587184554509
Round 27: D(curr, prev) = 38.1051177665153
Round 28: D(curr, prev) = 44.56455991031439
Round 29: D(curr, prev) = 42.941821107167776
Round 30: D(curr, prev) = 41.0
Round 31: D(curr, prev) = 37.94733192202055
Round 32: D(curr, prev) = 38.781438859330635
Round 33: D(curr, prev) = 38.561638969317684
Round 34: D(curr, prev) = 35.93048844644336
Round 35: D(curr, prev) = 32.2490309931942
Round 36: D(curr, prev) = 32.87856444554719
Round 37: D(curr, prev) = 30.315012782448235
Round 38: D(curr, prev) = 32.46536616149585
Round 39: D(curr, prev) = 31.51190251317746
Round 40: D(curr, prev) = 28.844410203711913
Round 41: D(curr, prev) = 29.154759474226502
Round 42: D(curr, prev) = 30.01666203960727
Round 43: D(curr, prev) = 27.76688675382964
Round 44: D(curr, prev) = 26.49528259898354
Round 45: D(curr, prev) = 26.720778431774775
Round 46: D(curr, prev) = 24.79919353527449
Round 47: D(curr, prev) = 24.55605831561735
Round 48: D(curr, prev) = 23.874672772626646
Round 49: D(curr, prev) = 21.02379604162864
Round 50: D(curr, prev) = 21.908902300206645
Round 51: D(curr, prev) = 22.825424421026653
Round 52: D(curr, prev) = 25.238858928247925
Round 53: D(curr, prev) = 25.534290669607408
Round 54: D(curr, prev) = 26.13426869074396
Round 55: D(curr, prev) = 24.020824298928627
Round 56: D(curr, prev) = 23.473389188611005
Round 57: D(curr, prev) = 21.97726097583591
Round 58: D(curr, prev) = 19.390719429665317
Round 59: D(curr, prev) = 19.28730152198591
Round 60: D(curr, prev) = 18.734993995195193
Round 61: D(curr, prev) = 16.73320053068151
Round 62: D(curr, prev) = 16.431676725154983
Round 63: D(curr, prev) = 15.524174696260024
Round 64: D(curr, prev) = 13.2664991614216
Round 65: D(curr, prev) = 13.527749258468683
Round 66: D(curr, prev) = 13.038404810405298
Round 67: D(curr, prev) = 11.269427669584644
Round 68: D(curr, prev) = 9.433981132056603
Round 69: D(curr, prev) = 9.746794344808963
Round 70: D(curr, prev) = 9.591663046625438
Round 71: D(curr, prev) = 8.660254037844387
Round 72: D(curr, prev) = 9.1104335791443
Round 73: D(curr, prev) = 8.54400374531753
Round 74: D(curr, prev) = 7.14142842854285
Round 75: D(curr, prev) = 8.12403840463596
Round 76: D(curr, prev) = 9.219544457292887
Round 77: D(curr, prev) = 9.591663046625438
Round 78: D(curr, prev) = 7.874007874011811
Round 79: D(curr, prev) = 6.6332495807108
Round 80: D(curr, prev) = 5.477225575051661
Round 81: D(curr, prev) = 2.449489742783178
Round 82: D(curr, prev) = 0.0
Achieve convergence at round = 82
```

Also, use the collected center point, use below codes to get result

```java
package com.monsterxia;

import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.math.BigInteger;

public class ResultA {
    public static void main(String[] args) throws IOException {
        String inputName = "train_img";
        String centerName = "output1";
        String resourcesPath = RandomInit.class.getClassLoader().getResource("train_img").getPath();
        String outputPath = resourcesPath.substring(0, resourcesPath.indexOf("/target/classes")) + "/src/main/resources/";
        inputName = outputPath + inputName;
        centerName = outputPath + centerName;

        BufferedReader br = new BufferedReader(new FileReader(inputName));
        BufferedReader centerReader = new BufferedReader(new FileReader(centerName));

        BigInteger[][] average = new BigInteger[10][784];

        for (int i = 0; i < 10; i++) {
            String line = centerReader.readLine();
            String[] pixels = line.split(",");
            for (int j = 0; j < pixels.length; j++) {
                average[i][j] = new BigInteger(pixels[j]);
            }
        }

        int[] count = new int[10];

        String image;
        while( (image = br.readLine() ) != null) {
            int tag = closest(image, average);
            count[tag]++;
        }

        StringBuilder sb = new StringBuilder();
        for (int i = 0; i < 10; i++) {
            sb.append("Centroid ").append(i).append(": ").append(count[i]).append(", [");
            for (int j = 0; j < 784; j++) {
                sb.append(average[i][j]).append(",");
            }
            sb.deleteCharAt(sb.length()-1).append("]\n");
        }
        System.out.println(sb);
    }

    public static int closest(String image, BigInteger[][] average) {
        BigInteger[] distance = new BigInteger[10];
        for (int i = 0; i < 10; i++) {
            distance[i] = new BigInteger("0");
        }

        String[] temp = image.split(",");
        for (int i = 0; i < temp.length; i++) {
            BigInteger test = new BigInteger(temp[i]);
            for (int j = 0; j < 10; j++) {
                BigInteger temp2 = average[j][i].subtract(test).abs();
                distance[j] = distance[j].add(
                        temp2.multiply(temp2)
                );
            }
        }

        BigInteger min = distance[0];
        int minIndex = 0;
        for (int i = 1; i < distance.length; i++) {
            if (distance[i].compareTo(min) < 0) {
                min = distance[i];
                minIndex = i;
            }
        }

        return minIndex;
    }
}

```

Result are:

```sql
Centroid 0: 6372, [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,5,10,18,26,32,33,31,25,18,13,8,5,2,0,0,0,0,0,0,0,0,0,0,0,1,2,7,18,39,68,98,123,137,139,128,108,81,56,37,22,11,3,0,0,0,0,0,0,0,0,0,1,4,11,29,62,105,148,178,193,198,198,190,170,136,99,65,40,21,7,1,0,0,0,0,0,0,0,1,3,11,29,64,114,161,190,195,187,178,177,181,176,153,115,77,47,25,8,1,0,0,0,0,0,0,0,2,7,20,50,96,146,177,174,149,124,112,119,140,154,140,107,70,41,20,7,1,0,0,0,0,0,0,0,3,10,28,65,113,152,158,128,90,66,67,89,121,137,122,88,54,29,13,4,0,0,0,0,0,0,0,1,3,12,33,71,118,146,136,95,58,48,64,98,129,131,103,66,37,18,7,2,0,0,0,0,0,0,0,1,3,12,33,73,119,145,132,93,66,70,98,128,137,115,76,42,20,8,3,1,0,0,0,0,0,0,0,0,3,11,32,71,118,149,149,125,109,120,141,146,123,83,46,21,9,4,1,0,0,0,0,0,0,0,0,0,2,10,29,66,113,155,175,172,165,171,168,139,92,50,21,9,3,1,0,0,0,0,0,0,0,0,0,0,2,8,25,58,103,150,184,198,199,192,165,117,67,31,11,4,1,0,0,0,0,0,0,0,0,0,0,0,1,7,21,50,91,137,174,190,191,179,149,107,64,28,8,2,0,0,0,0,0,0,0,0,0,0,0,1,2,8,23,52,91,129,151,155,154,151,140,115,73,31,8,1,0,0,0,0,0,0,0,0,0,0,1,3,7,16,36,68,101,121,120,109,113,130,143,130,84,33,7,1,0,0,0,0,0,0,0,0,0,2,4,9,17,32,58,90,110,107,84,70,86,125,154,142,89,32,7,1,0,0,0,0,0,0,0,0,0,3,8,18,32,55,84,108,110,87,61,57,88,137,167,144,84,29,7,1,0,0,0,0,0,0,0,0,1,4,11,25,49,81,110,125,116,89,73,84,124,165,171,130,68,23,6,1,0,0,0,0,0,0,0,0,0,4,11,28,59,98,132,149,148,134,130,146,170,179,154,100,47,16,5,1,0,0,0,0,0,0,0,0,0,2,8,23,54,96,138,170,187,193,195,195,188,161,112,62,27,9,3,1,0,0,0,0,0,0,0,0,0,1,5,14,35,69,109,149,179,195,194,177,144,102,60,30,12,4,1,0,0,0,0,0,0,0,0,0,0,0,1,4,13,27,48,72,93,103,101,85,61,37,19,8,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,4,6,7,8,7,6,4,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
Centroid 1: 3134, [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,5,6,6,7,8,7,5,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,3,7,15,29,50,71,83,80,68,47,28,14,5,2,0,0,0,0,0,0,0,0,0,0,0,1,1,3,8,21,47,82,119,149,162,159,138,103,66,34,14,4,0,0,0,0,0,0,0,0,0,0,0,1,3,7,22,53,98,143,177,194,201,201,184,151,107,62,26,6,0,0,0,0,0,0,0,0,0,0,1,2,6,19,52,103,154,189,202,200,198,197,192,173,137,89,41,10,1,0,0,0,0,0,0,0,0,0,1,4,14,46,101,159,196,205,193,174,159,161,171,171,149,105,53,14,1,0,0,0,0,0,0,0,0,0,2,9,37,93,157,201,208,185,151,119,105,115,142,160,149,113,61,16,0,0,0,0,0,0,0,0,0,1,6,28,80,149,201,211,183,139,97,69,62,79,118,151,149,115,65,17,0,0,0,0,0,0,0,0,0,3,19,64,133,195,215,187,137,90,59,43,43,65,110,151,153,115,64,18,0,0,0,0,0,0,0,0,1,12,46,111,180,214,195,140,88,56,40,35,40,67,117,158,156,113,59,15,0,0,0,0,0,0,0,1,7,31,85,154,204,200,148,87,49,35,29,30,41,78,133,171,157,104,50,11,0,0,0,0,0,0,0,3,19,60,123,181,199,160,93,45,26,21,21,26,48,97,157,185,153,91,38,7,0,0,0,0,0,0,0,8,38,92,150,187,171,112,52,22,15,14,18,29,65,126,186,190,137,71,24,4,0,0,0,0,0,0,0,16,63,120,166,177,137,73,28,13,11,14,23,47,99,169,208,179,109,45,12,1,0,0,0,0,0,0,1,29,88,142,174,163,111,52,21,14,17,26,48,90,155,208,205,145,69,22,5,0,0,0,0,0,0,0,2,40,105,156,178,154,101,53,31,31,42,64,103,157,205,213,168,92,31,7,1,0,0,0,0,0,0,0,3,44,112,163,184,163,119,82,68,76,98,132,174,209,212,174,104,40,11,2,0,0,0,0,0,0,0,0,4,38,102,160,192,190,166,143,138,150,172,198,212,204,164,100,41,12,3,1,0,0,0,0,0,0,0,0,3,25,75,135,184,208,211,205,203,207,210,205,185,140,83,36,11,3,1,0,0,0,0,0,0,0,0,0,1,11,41,88,139,180,201,208,204,195,178,147,102,57,24,8,2,1,0,0,0,0,0,0,0,0,0,0,0,2,13,33,66,102,129,140,137,118,89,57,30,12,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,4,10,18,24,29,29,24,16,8,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
Centroid 2: 10232, [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,2,2,3,3,3,3,4,4,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,6,9,16,26,35,39,39,37,31,24,16,9,4,1,0,0,0,0,0,0,0,0,0,0,1,2,3,6,9,17,30,50,68,78,79,72,59,43,28,15,6,3,1,0,0,0,0,0,0,0,0,0,1,3,5,8,12,21,38,62,87,104,105,94,74,50,31,16,8,5,3,1,0,0,0,0,0,0,0,1,2,4,7,9,14,23,40,68,100,122,123,106,79,51,29,16,10,8,5,2,0,0,0,0,0,0,0,1,3,4,6,8,12,20,37,71,112,139,137,112,78,46,25,16,12,10,8,3,0,0,0,0,0,0,0,1,2,3,4,6,9,17,37,78,128,157,147,110,69,37,20,13,11,9,7,3,0,0,0,0,0,0,0,1,1,2,3,4,8,17,42,91,147,174,148,98,51,23,12,9,7,6,4,1,0,0,0,0,0,0,0,0,1,1,2,5,10,23,51,105,168,184,139,75,30,11,5,4,3,2,1,0,0,0,0,0,0,0,0,0,0,1,2,7,16,30,58,123,188,189,123,50,14,4,2,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,3,10,20,35,67,148,205,189,102,31,8,3,2,1,1,1,0,0,0,0,0,0,0,0,0,0,0,1,5,12,22,39,82,173,214,180,78,22,9,5,2,2,1,1,0,0,0,0,0,0,0,0,0,0,1,2,6,12,23,46,103,185,212,158,60,21,11,5,3,2,2,1,1,0,0,0,0,0,0,0,0,1,3,4,7,13,27,60,121,187,197,131,53,24,13,6,3,2,2,1,1,0,0,0,0,0,0,0,0,3,6,7,10,17,38,78,133,180,172,108,51,26,13,6,4,3,2,2,1,1,0,0,0,0,0,0,0,4,9,11,14,27,54,94,138,168,150,96,50,25,12,6,5,4,3,3,2,0,0,0,0,0,0,0,0,4,11,16,23,41,72,108,139,153,133,90,49,24,11,6,5,4,3,2,1,0,0,0,0,0,0,0,0,4,11,19,33,57,87,116,136,140,121,84,48,23,12,7,5,4,3,2,1,0,0,0,0,0,0,0,0,2,9,19,38,63,91,114,125,125,108,77,45,22,11,7,5,3,2,1,0,0,0,0,0,0,0,0,0,2,7,18,36,59,83,100,107,105,92,66,39,19,9,5,3,2,1,0,0,0,0,0,0,0,0,0,0,2,6,14,28,45,61,71,74,73,65,47,27,12,5,2,1,1,0,0,0,0,0,0,0,0,0,0,0,0,2,5,9,14,20,23,24,25,22,15,8,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,3,4,5,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
Centroid 3: 7665, [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,2,2,2,2,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,7,13,22,34,45,56,62,63,58,47,34,23,14,9,5,3,1,0,0,0,0,0,0,0,0,1,6,14,27,48,76,107,138,160,172,171,160,138,108,76,50,31,18,10,5,2,0,0,0,0,0,0,1,5,13,29,54,88,126,163,188,198,198,196,192,180,154,117,78,47,26,14,7,3,1,0,0,0,0,0,1,8,19,40,69,103,137,158,161,151,141,139,147,154,147,122,84,48,25,12,5,2,0,0,0,0,0,0,2,8,19,39,64,91,113,117,103,83,72,76,96,117,125,111,78,42,20,8,3,1,0,0,0,0,0,0,1,6,15,31,51,73,86,83,67,48,44,58,84,108,117,101,67,35,15,6,2,0,0,0,0,0,0,0,1,4,10,22,40,60,73,74,64,56,62,83,108,122,116,89,54,26,10,4,1,0,0,0,0,0,0,0,0,2,7,17,34,56,76,88,94,102,117,134,145,141,117,80,45,21,8,2,0,0,0,0,0,0,0,0,0,1,5,14,31,58,89,118,141,158,172,179,177,161,128,87,52,24,8,2,0,0,0,0,0,0,0,0,0,0,3,11,28,57,94,132,160,179,186,186,179,166,143,112,75,40,16,4,1,0,0,0,0,0,0,0,0,0,2,8,21,46,81,112,135,147,150,149,148,149,148,136,106,64,30,10,2,0,0,0,0,0,0,0,0,0,2,5,14,31,54,75,88,93,92,89,94,109,132,145,131,90,46,19,5,1,0,0,0,0,0,0,0,1,2,4,9,20,34,45,50,49,44,40,46,65,103,141,144,109,62,28,9,2,0,0,0,0,0,0,1,2,5,7,12,20,29,35,35,31,23,17,19,37,82,134,150,119,72,35,13,3,0,0,0,0,0,0,1,5,9,14,21,28,35,38,34,26,16,9,10,30,79,136,155,123,76,39,14,3,0,0,0,0,0,0,2,8,16,26,36,46,52,52,43,30,18,13,21,50,102,151,159,121,74,37,13,3,0,0,0,0,0,0,3,10,22,36,54,72,82,82,70,54,44,46,64,101,146,173,156,109,62,29,10,2,0,0,0,0,0,0,3,10,22,42,67,95,118,129,126,117,113,120,141,168,185,173,132,83,43,18,6,1,0,0,0,0,0,0,2,7,17,35,62,96,132,161,181,189,192,196,201,196,174,134,86,48,21,8,2,0,0,0,0,0,0,0,1,4,9,20,38,64,96,132,164,186,195,189,172,142,105,67,38,17,7,2,0,0,0,0,0,0,0,0,0,1,3,6,12,21,34,49,66,79,84,79,66,49,31,17,8,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,2,3,4,4,5,5,4,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
Centroid 4: 6778, [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,4,4,2,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,2,3,4,5,4,4,4,6,11,15,16,14,11,5,1,0,0,0,0,0,0,0,0,1,2,4,7,12,17,24,31,38,44,50,53,54,51,44,36,27,18,9,3,0,0,0,0,0,0,1,3,7,12,19,28,42,59,81,102,113,118,121,125,130,125,103,74,47,28,14,5,1,0,0,0,0,1,3,7,14,24,38,58,87,124,156,169,164,151,145,152,169,172,145,101,60,31,15,6,1,0,0,0,0,1,4,10,19,33,54,87,131,171,185,168,140,117,113,134,170,181,152,102,56,25,10,4,0,0,0,0,0,1,4,10,19,35,64,107,154,173,151,109,76,62,73,116,168,178,140,85,41,16,6,2,0,0,0,0,0,1,4,8,18,38,75,124,153,139,91,49,30,32,67,132,181,171,118,61,25,8,2,0,0,0,0,0,0,0,2,6,17,44,87,128,136,99,52,27,25,44,103,171,192,152,88,38,14,4,1,0,0,0,0,0,0,0,1,6,20,50,92,122,116,81,53,45,53,91,159,203,184,120,59,24,8,3,1,0,0,0,0,0,0,0,1,7,25,54,88,108,104,90,81,80,97,148,204,210,157,86,39,17,8,3,1,0,0,0,0,0,0,0,1,9,26,49,75,90,95,96,96,102,132,191,222,189,116,55,26,14,7,3,1,0,0,0,0,0,0,0,1,9,22,38,53,64,71,75,80,102,161,217,209,142,69,30,14,8,5,2,1,0,0,0,0,0,0,0,1,6,13,22,29,34,38,44,61,115,194,220,166,83,30,11,6,3,1,1,0,0,0,0,0,0,0,0,1,3,7,10,13,15,18,33,74,156,217,193,108,38,10,3,2,1,1,0,0,0,0,0,0,0,0,0,1,2,5,7,8,10,20,51,117,198,211,142,56,14,3,1,1,0,0,0,0,0,0,0,0,0,0,0,0,2,6,8,11,18,41,89,165,213,174,86,22,5,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,2,6,10,17,35,72,132,195,192,121,41,8,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,5,12,27,56,103,161,192,150,73,18,4,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,6,18,40,75,123,167,163,107,40,9,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,9,23,48,83,124,146,122,66,21,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,9,21,43,69,95,99,72,32,9,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,4,10,20,29,38,39,25,9,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,2,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
Centroid 5: 4728, [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,2,3,3,4,4,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,6,11,18,27,36,45,49,50,45,36,24,15,8,4,1,0,0,0,0,0,0,0,0,0,0,1,3,9,19,34,53,77,102,122,133,134,126,104,77,52,30,15,5,1,0,0,0,0,0,0,0,0,0,3,9,21,40,64,92,121,147,165,177,180,172,155,123,88,56,29,12,3,0,0,0,0,0,0,0,0,1,6,15,33,56,83,110,134,148,157,163,169,171,166,147,115,79,44,19,5,0,0,0,0,0,0,0,0,2,8,19,38,59,80,99,112,115,114,115,122,136,150,150,128,93,56,25,6,0,0,0,0,0,0,0,0,2,8,19,34,50,63,73,75,73,69,68,78,102,131,146,133,100,60,28,7,0,0,0,0,0,0,0,0,1,6,16,26,35,40,44,44,39,35,37,52,83,123,146,137,102,60,26,6,0,0,0,0,0,0,0,0,1,4,11,16,20,23,24,22,19,20,26,46,84,127,150,138,98,55,22,5,0,0,0,0,0,0,0,0,0,3,6,8,10,12,12,12,13,18,31,56,96,137,154,135,90,45,17,4,0,0,0,0,0,0,0,0,0,2,4,5,6,8,9,13,19,30,47,76,113,149,155,124,75,34,12,3,1,0,0,0,0,0,0,0,0,2,4,7,10,14,21,30,41,55,74,101,134,157,148,108,59,25,9,4,2,0,0,0,0,0,0,0,1,4,10,18,27,40,53,67,81,96,113,135,155,159,135,91,47,19,8,5,3,1,0,0,0,0,0,0,3,12,26,43,61,81,99,115,129,142,155,165,167,155,122,79,43,22,13,9,6,2,0,0,0,0,0,2,10,27,53,79,102,122,135,147,159,171,179,181,172,149,115,78,50,32,23,17,10,4,0,0,0,0,0,5,20,47,82,111,132,141,146,154,165,178,184,182,170,148,120,92,68,52,39,28,17,7,1,0,0,0,0,9,32,68,107,136,149,152,155,160,169,180,183,179,168,152,134,112,93,76,58,41,23,8,0,0,0,0,0,12,39,80,124,156,173,176,177,178,181,182,177,167,157,147,137,124,109,91,69,46,24,8,1,0,0,0,1,12,40,79,126,164,189,198,195,189,179,164,147,132,123,119,118,113,101,84,62,40,20,6,0,0,0,0,0,9,30,63,105,143,170,181,175,160,140,117,97,82,76,77,80,80,73,60,43,27,13,3,0,0,0,0,0,4,15,35,63,91,111,118,112,96,76,57,43,36,35,37,41,43,40,33,23,14,6,1,0,0,0,0,0,1,4,11,20,30,37,37,33,26,18,12,9,8,9,10,12,13,13,11,7,4,1,0,0,0,0,0,0,0,0,1,2,2,2,2,1,1,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
Centroid 6: 7288, [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,2,2,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,4,7,9,10,11,11,11,11,11,9,6,3,1,0,0,0,0,0,0,0,0,0,0,1,3,5,9,14,23,34,47,57,63,66,61,51,38,25,15,8,4,2,1,0,0,0,0,0,0,1,4,8,14,22,32,48,71,99,120,130,133,133,130,117,88,55,28,13,6,4,2,1,0,0,0,0,1,4,9,18,29,43,62,93,133,163,170,161,150,150,159,160,132,84,43,19,8,4,2,1,0,0,0,0,2,6,13,23,37,55,84,127,167,176,155,126,111,119,147,168,150,100,50,21,8,3,1,1,0,0,0,0,2,5,11,20,33,55,92,139,162,141,100,70,62,82,129,167,153,102,50,19,6,2,0,0,0,0,0,0,1,4,7,13,25,50,95,137,139,96,53,33,35,66,127,170,153,96,44,16,5,1,0,0,0,0,0,0,0,2,4,8,19,48,97,134,118,71,35,27,39,80,144,179,148,86,36,13,3,0,0,0,0,0,0,0,0,0,2,5,16,46,95,128,111,72,51,50,67,109,168,188,140,75,30,11,3,1,0,0,0,0,0,0,0,0,1,4,15,43,87,118,114,94,85,88,100,137,188,193,133,65,26,11,5,2,0,0,0,0,0,0,0,0,1,4,13,34,70,100,108,106,106,106,114,151,200,192,120,54,22,10,5,2,1,0,0,0,0,0,0,0,0,3,9,22,45,69,83,88,90,90,104,158,210,183,99,38,14,7,4,2,0,0,0,0,0,0,0,0,0,1,5,12,22,35,44,49,52,55,87,166,215,164,72,22,8,4,2,1,0,0,0,0,0,0,0,0,0,0,2,5,8,13,17,20,23,33,89,180,210,139,49,11,3,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,2,4,5,7,11,31,109,193,194,111,33,6,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,2,4,9,48,134,198,172,87,24,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,2,5,18,75,155,193,147,70,20,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,8,35,101,168,179,126,60,18,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,5,17,57,119,167,158,107,53,17,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,8,26,68,119,144,125,84,42,14,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,8,25,59,91,96,78,52,27,10,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,11,28,40,39,29,18,9,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,4,4,3,1,0,0,0,0,0,0,0,0,0,0,0]
Centroid 7: 3042, [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,4,6,7,6,5,4,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,7,14,26,44,61,71,71,61,45,29,16,8,3,0,0,0,0,0,0,0,0,0,0,0,0,1,4,11,24,47,80,115,143,157,157,146,122,90,59,31,13,4,1,0,0,0,0,0,0,0,0,0,1,4,11,27,57,100,145,177,192,195,193,186,174,151,113,73,37,13,3,0,0,0,0,0,0,0,0,0,2,8,23,55,104,156,190,197,189,180,174,176,181,179,160,120,73,33,9,1,0,0,0,0,0,0,0,0,4,16,45,95,154,194,197,175,149,130,125,129,146,164,174,160,114,62,22,4,0,0,0,0,0,0,0,1,7,30,78,141,191,198,168,127,96,78,75,80,96,122,155,172,150,98,41,8,0,0,0,0,0,0,0,1,15,53,116,178,201,173,123,78,54,43,41,43,54,80,122,163,169,131,67,16,0,0,0,0,0,0,0,3,27,81,153,197,187,134,77,41,30,24,24,26,33,50,91,145,175,155,94,27,0,0,0,0,0,0,0,5,44,113,179,196,157,93,42,22,17,15,17,18,22,33,68,126,173,168,115,40,1,0,0,0,0,0,0,9,64,138,189,183,126,61,23,14,12,12,13,14,16,24,51,110,170,177,129,50,2,0,0,0,0,0,0,15,83,153,190,166,99,41,15,11,11,11,11,10,11,17,43,103,169,181,135,53,2,0,0,0,0,0,0,20,97,160,186,151,83,32,12,9,9,9,8,7,8,15,44,110,175,182,130,49,2,0,0,0,0,0,0,23,102,163,183,144,77,28,11,8,7,7,6,6,8,21,62,132,184,176,114,39,1,0,0,0,0,0,0,23,99,160,182,148,84,32,12,8,7,8,7,9,17,43,99,164,190,157,87,26,1,0,0,0,0,0,0,21,86,150,183,164,106,51,24,15,13,14,17,25,46,92,150,190,179,123,57,14,0,0,0,0,0,0,0,15,67,132,179,183,145,94,58,42,37,39,48,69,106,152,188,189,143,80,30,5,0,0,0,0,0,0,0,8,42,100,158,191,184,152,119,98,91,96,113,140,172,194,190,149,91,41,12,2,0,0,0,0,0,0,0,3,21,60,115,167,196,195,182,170,165,170,181,195,200,182,140,87,42,15,3,0,0,0,0,0,0,0,0,1,7,26,61,109,155,185,198,201,202,202,198,184,155,113,68,33,13,3,0,0,0,0,0,0,0,0,0,0,1,6,20,43,77,110,138,155,158,149,129,101,68,39,18,7,2,0,0,0,0,0,0,0,0,0,0,0,0,0,2,7,15,26,36,43,45,40,32,21,12,6,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
Centroid 8: 5416, [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,4,5,5,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,6,10,11,9,5,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,7,13,16,16,12,7,4,3,4,5,5,5,4,3,2,1,0,0,0,0,0,0,0,0,0,2,5,9,18,27,32,29,23,16,13,12,16,20,21,18,15,11,8,4,1,0,0,0,0,0,0,0,1,5,11,21,36,54,63,61,56,50,47,45,46,47,45,38,28,20,14,8,3,0,0,0,0,0,0,1,4,10,21,40,69,96,107,101,91,84,78,77,77,78,73,59,44,30,19,10,3,0,0,0,0,0,1,3,8,18,36,68,110,139,138,116,95,83,78,82,92,101,100,83,60,39,22,10,3,0,0,0,0,0,2,5,12,26,54,99,145,161,137,99,74,61,58,68,89,114,122,106,76,46,24,9,2,0,0,0,0,0,2,6,15,36,74,126,165,156,110,69,46,37,37,52,84,121,138,126,89,51,25,8,2,0,0,0,0,0,1,5,17,43,89,144,167,136,80,43,27,24,28,47,84,129,153,140,96,54,26,10,3,0,0,0,0,0,1,5,18,48,100,153,163,118,61,30,21,22,32,55,95,142,165,145,97,55,28,14,6,1,0,0,0,0,0,4,18,51,107,158,162,116,65,41,36,42,55,79,115,158,173,145,95,53,31,18,9,1,0,0,0,0,0,3,17,51,108,158,168,135,96,78,77,85,98,117,141,172,179,144,92,54,34,23,12,2,0,0,0,0,0,3,14,46,98,146,167,155,135,124,124,131,139,145,157,180,183,142,90,54,37,24,13,3,0,0,0,0,0,2,10,36,76,116,145,152,147,143,141,141,140,138,151,180,184,136,84,52,36,23,12,4,0,0,0,0,0,1,6,23,48,77,101,116,118,116,111,107,102,104,133,174,178,126,77,47,31,19,9,2,0,0,0,0,0,0,3,12,25,40,56,68,74,73,68,65,64,75,119,169,168,115,68,41,25,14,6,1,0,0,0,0,0,0,1,5,10,16,24,33,40,42,42,42,46,65,115,162,157,106,62,35,20,10,3,0,0,0,0,0,0,0,0,1,3,5,8,13,19,24,28,33,42,65,114,155,146,98,55,29,15,7,2,0,0,0,0,0,0,0,0,0,1,2,3,5,8,12,17,25,37,62,107,142,131,88,49,25,12,5,1,0,0,0,0,0,0,0,0,0,0,1,2,3,4,6,10,18,30,55,95,125,115,80,47,24,11,5,1,0,0,0,0,0,0,0,0,0,0,0,1,2,3,5,9,17,30,52,85,109,101,73,44,22,10,4,1,0,0,0,0,0,0,0,0,0,0,0,1,1,2,4,7,14,24,42,65,82,77,55,33,16,7,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,3,7,13,23,36,45,41,29,16,8,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,9,13,15,13,9,5,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,2,2,1,0,0,0,0,0,0,0,0,0]
Centroid 9: 5345, [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,5,11,20,28,34,37,34,28,20,11,5,2,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,7,15,28,47,68,84,88,81,66,46,26,12,5,1,0,0,0,0,0,0,0,0,0,0,0,1,2,5,13,27,49,78,104,119,118,101,77,49,26,12,5,1,0,0,0,0,0,0,0,0,0,0,1,2,3,8,20,42,74,107,130,135,120,92,62,34,17,7,3,1,0,0,0,0,0,0,0,0,0,0,1,2,5,13,31,64,103,132,143,131,101,67,38,18,8,4,2,1,1,0,0,0,0,0,0,0,0,0,1,3,7,20,48,90,128,149,143,113,74,42,20,9,5,3,2,2,1,0,0,0,0,0,0,0,0,0,1,3,10,30,70,117,149,155,128,84,47,24,13,7,4,2,2,2,1,0,0,0,0,0,0,0,0,0,2,4,16,46,96,142,164,147,100,55,27,15,12,10,6,4,2,2,1,0,0,0,0,0,0,0,0,0,2,6,25,67,123,164,166,123,68,34,21,20,21,20,14,9,5,2,1,0,0,0,0,0,0,0,0,0,2,10,38,91,150,177,151,94,48,32,34,42,48,46,34,21,11,4,1,0,0,0,0,0,0,0,0,0,3,16,54,117,171,178,129,73,50,57,74,89,94,88,69,43,22,8,3,0,0,0,0,0,0,0,0,0,5,25,74,140,183,166,110,74,81,105,127,140,140,128,102,68,36,15,5,1,0,0,0,0,0,0,0,1,9,36,92,159,185,152,103,95,120,146,158,159,156,149,126,87,48,20,7,1,0,0,0,0,0,0,0,2,13,47,108,169,181,143,112,121,143,151,143,136,143,151,138,99,56,25,8,2,0,0,0,0,0,0,0,3,18,56,117,172,178,146,127,133,137,123,104,105,132,154,144,101,57,24,9,2,0,0,0,0,0,0,0,5,21,59,119,171,182,160,139,131,118,97,89,110,148,165,140,91,47,19,7,2,0,0,0,0,0,0,0,5,20,56,112,167,192,182,155,136,120,112,123,153,177,164,118,69,32,12,4,1,0,0,0,0,0,0,0,3,14,43,93,152,195,203,188,170,161,164,179,189,175,131,81,41,17,7,2,1,0,0,0,0,0,0,0,1,7,25,61,115,169,205,215,212,207,203,194,170,127,79,41,18,7,3,1,0,0,0,0,0,0,0,0,0,2,8,26,59,105,149,178,191,186,167,137,99,60,31,14,5,2,1,0,0,0,0,0,0,0,0,0,0,0,1,4,12,27,46,64,76,76,65,47,29,15,7,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,6,9,10,8,6,4,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
```

### b.  [20 marks] 

Try another initialize method

```java
package com.monsterxia;

import java.io.*;
import java.math.BigDecimal;
import java.math.BigInteger;

public class Init2 {
    public static void main(String[] args) {

        String inputName = "train_img";
        String tagName = "train_label";
        String fileName = "RandomInit2";

        String resourcesPath = RandomInit.class.getClassLoader().getResource("train_img").getPath();
        String outputPath = resourcesPath.substring(0, resourcesPath.indexOf("/target/classes")) + "/src/main/resources/";
        fileName = outputPath + fileName;

        try {
            BufferedReader imageReader = new BufferedReader(new FileReader(Init2.class.getClassLoader().getResource(inputName).getFile()));
            BufferedReader tagReader = new BufferedReader(new FileReader(Init2.class.getClassLoader().getResource(tagName).getFile()));

            BigInteger[][] sum = new BigInteger[10][784];
            for (int i = 0; i < 10; i++) {
                for (int j = 0; j < 784; j++) {
                    sum[i][j] = new BigInteger(String.valueOf(0));
                }
            }

            int[] count = new int[10];

            String image;
            String tag;
            while( (image = imageReader.readLine() ) != null) {
                tag = tagReader.readLine();
                int index = Integer.parseInt(tag);
                count[index]++;

                String[] pixels = image.split(",");
                for (int i = 0; i < pixels.length; i++) {
                    BigInteger test = new BigInteger(pixels[i]);
                    sum[index][i] = sum[index][i].add(test);
                }
            }

            FileWriter fileWriter = new FileWriter(fileName);

            for (int i = 0; i < 10; i++) {
                StringBuilder sb = new StringBuilder();
                for (int j = 0; j < 784; j++) {
                    sum[i][j] = sum[i][j].divide(new BigInteger(String.valueOf(count[i])));
                    sb.append(sum[i][j]).append(",");
                }
                sb.deleteCharAt(sb.length()-1).append("\n");
                fileWriter.write(sb.toString());
            }

            fileWriter.close();
        } catch (IOException e) {
            throw new RuntimeException(e);
        }
    }
}

```

Together with provided seed, let all runs K-Means like a to get center points.

For collected center points, count correct for every Cluster

```java
package com.monsterxia;

import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.math.BigInteger;
import java.text.DecimalFormat;
import java.util.Arrays;

public class ResultB {
    public static void main(String[] args) throws IOException {
        String inputName = "train_img";
        String tagName = "train_label";
        String centerName = "output1";
        String resourcesPath = RandomInit.class.getClassLoader().getResource("train_img").getPath();
        String outputPath = resourcesPath.substring(0, resourcesPath.indexOf("/target/classes")) + "/src/main/resources/";
        inputName = outputPath + inputName;
        tagName = outputPath + tagName;
        centerName = outputPath + centerName;

        BufferedReader br = new BufferedReader(new FileReader(inputName));
        BufferedReader tagReader = new BufferedReader(new FileReader(tagName));
        BufferedReader centerReader = new BufferedReader(new FileReader(centerName));

        BigInteger[][] average = new BigInteger[10][784];

        for (int i = 0; i < 10; i++) {
            String line = centerReader.readLine();
            String[] pixels = line.split(",");
            for (int j = 0; j < pixels.length; j++) {
                average[i][j] = new BigInteger(pixels[j]);
            }
        }

        int[][] count = new int[10][10];
        for (int i = 0; i < 10; i++) {
            Arrays.fill(count[i], 0);
        }

        String image;
        String tag;
        while( (image = br.readLine() ) != null) {
            tag = tagReader.readLine();
            int index = Integer.parseInt(tag);
            int predict = closest(image, average);
            count[predict][index]++;
        }

        int totalNum = 0;
        int totalCorrect = 0;
        StringBuilder sb = new StringBuilder();
        DecimalFormat df = new DecimalFormat("#.00");
        for (int i = 0; i < 10; i++) {
            sb.append("Cluster ").append(i).append(", ");
            int num = 0;
            int max = 0;
            int index = 0;
            for (int j = 0; j < 10; j++) {
                num += count[i][j];
                if (count[i][j] > max) {
                    max = count[i][j];
                    index = j;
                }
            }

            sb.append(index).append(", ").append(num).append(", ").append(max).append(", ");
            double accuracy = (double) 100 * max / num;
            String formattedAccuracy = df.format(accuracy);
            sb.append(formattedAccuracy).append("\n");
            totalNum += num;
            totalCorrect += max;
        }
        sb.append("TotalSet,").append("N/A,").append(totalNum).append(",").append(totalCorrect).append(", ");
        double totalAccuracy = (double) 100 * totalCorrect / totalNum;
        String formattedTotalAccuracy = df.format(totalAccuracy);
        sb.append(formattedTotalAccuracy).append("\n");
        System.out.println(sb);
    }

    public static int closest(String image, BigInteger[][] average) {
        BigInteger[] distance = new BigInteger[10];
        for (int i = 0; i < 10; i++) {
            distance[i] = new BigInteger("0");
        }

        String[] temp = image.split(",");
        for (int i = 0; i < temp.length; i++) {
            BigInteger test = new BigInteger(temp[i]);
            for (int j = 0; j < 10; j++) {
                BigInteger temp2 = average[j][i].subtract(test).abs();
                distance[j] = distance[j].add(
                        temp2.multiply(temp2)
                );
            }
        }

        BigInteger min = distance[0];
        int minIndex = 0;
        for (int i = 1; i < distance.length; i++) {
            if (distance[i].compareTo(min) < 0) {
                min = distance[i];
                minIndex = i;
            }
        }

        return minIndex;
    }
}

```

Thus get the following result.

<p align=center><strong>Table 1. The Accuracy of Clustering Performance with Random Seed 1</strong></p>

| Cluster Index | Major Label of the cluster | # Train images belonging to the cluster | # Correctly clustered images | Classification Accuracy (%) |
| :-----------: | :------------------------: | :-------------------------------------: | :--------------------------: | :-------------------------: |
|       0       |             8              |                  6372                   |             3408             |            53.48            |
|       1       |             0              |                  3134                   |             2502             |            79.83            |
|       2       |             1              |                  10232                  |             6596             |            64.46            |
|       3       |             3              |                  7665                   |             4027             |            52.54            |
|       4       |             7              |                  6778                   |             2780             |            41.02            |
|       5       |             2              |                  4728                   |             4215             |            89.15            |
|       6       |             7              |                  7288                   |             2481             |            34.04            |
|       7       |             0              |                  3042                   |             2772             |            91.12            |
|       8       |             4              |                  5416                   |             2258             |            41.69            |
|       9       |             6              |                  5345                   |             4577             |            85.63            |
|   Total Set   |            N/A             |                  60000                  |            35616             |            59.36            |

<p align=center><strong>Table 2. The Accuracy of Clustering Performance with Random Seed 2</strong></p>

| Cluster Index | Major Label of the cluster | # Train images belonging to the cluster | # Correctly clustered images | Classification Accuracy (%) |
| :-----------: | :------------------------: | :-------------------------------------: | :--------------------------: | :-------------------------: |
|       0       |             0              |                  4162                   |             3898             |            93.66            |
|       1       |             1              |                  9930                   |             6606             |            66.53            |
|       2       |             2              |                  4539                   |             4171             |            91.89            |
|       3       |             3              |                  7517                   |             3986             |            53.03            |
|       4       |             4              |                  5393                   |             2306             |            42.76            |
|       5       |             0              |                  4641                   |             1505             |            32.43            |
|       6       |             6              |                  4976                   |             4374             |            87.90            |
|       7       |             7              |                  6336                   |             2729             |            43.07            |
|       8       |             8              |                  5446                   |             3485             |            63.99            |
|       9       |             7              |                  7060                   |             2434             |            34.48            |
|   Total Set   |            N/A             |                  60000                  |            35494             |            59.16            |

<p align=center><strong>Table 3. The Accuracy of Clustering Performance with Provided Seed 1</strong></p>

| Cluster Index | Major Label of the cluster | # Train images belonging to the cluster | # Correctly clustered images | Classification Accuracy (%) |
| :-----------: | :------------------------: | :-------------------------------------: | :--------------------------: | :-------------------------: |
|       0       |             0              |                  4992                   |             4688             |            93.91            |
|       1       |             9              |                  7172                   |             2452             |            34.19            |
|       2       |             6              |                  5432                   |             4639             |            85.40            |
|       3       |             1              |                  5420                   |             3697             |            68.21            |
|       4       |             3              |                  7839                   |             3906             |            49.83            |
|       5       |             7              |                  6680                   |             2796             |            41.86            |
|       6       |             4              |                  5443                   |             2212             |            40.64            |
|       7       |             2              |                  4688                   |             4211             |            89.83            |
|       8       |             8              |                  7161                   |             3140             |            43.85            |
|       9       |             1              |                  5173                   |             2990             |            57.80            |
|   Total Set   |            N/A             |                  60000                  |            34731             |            57.88            |

<p align=center><strong>Table 4. The Accuracy of Clustering Performance with Provided Seed 2</strong></p>

| Cluster Index | Major Label of the cluster | # Train images belonging to the cluster | # Correctly clustered images | Classification Accuracy (%) |
| :-----------: | :------------------------: | :-------------------------------------: | :--------------------------: | :-------------------------: |
|       0       |             0              |                  4618                   |             4335             |            93.87            |
|       1       |             2              |                  4568                   |             4182             |            91.55            |
|       2       |             3              |                  7377                   |             3875             |            52.53            |
|       3       |             1              |                  4425                   |             3047             |            68.86            |
|       4       |             7              |                  8505                   |             3768             |            44.30            |
|       5       |             8              |                  5885                   |             3516             |            59.75            |
|       6       |             4              |                  9018                   |             3214             |            35.64            |
|       7       |             1              |                  5673                   |             3641             |            64.18            |
|       8       |             6              |                  5559                   |             1705             |            30.67            |
|       9       |             6              |                  4372                   |             3790             |            86.69            |
|   Total Set   |            N/A             |                  60000                  |            35073             |            58.45            |

Different initializations have different recognition accuracies for different classifications. In this step, I choose my first seed to continue as the accuracy of it is the most higher one.

### c. [10marks]

For c, only need to change the files‘ names in b to

```java
String inputName = "test_img";
String tagName = "test_label";
```

<p align=center><strong>Table 5. The Accuracy of Clustering Performance on the Test Set</strong></p>

| Cluster Index | Major Label of the cluster | # Train images belonging to the cluster | # Correctly clustered images | Classification Accuracy (%) |
| :-----------: | :------------------------: | :-------------------------------------: | :--------------------------: | :-------------------------: |
|       0       |             8              |                  1045                   |             569              |            54.45            |
|       1       |             0              |                   547                   |             427              |            78.06            |
|       2       |             1              |                  1642                   |             1107             |            67.42            |
|       3       |             3              |                  1352                   |             713              |            52.74            |
|       4       |             7              |                  1037                   |             419              |            40.41            |
|       5       |             2              |                   810                   |             720              |            88.89            |
|       6       |             9              |                  1333                   |             487              |            36.53            |
|       7       |             0              |                   486                   |             441              |            90.74            |
|       8       |             4              |                   898                   |             381              |            42.43            |
|       9       |             6              |                   850                   |             730              |            85.88            |
|   Total Set   |            N/A             |                  10000                  |             5994             |            59.94            |

In the case that training set has covered most of the case so for the test set, the accuracy has little difference with training set.

###  d. [bonus 20 marks] 

Use K-Means++ to initialized the center points by

```java
package com.monsterxia;

import java.io.*;

public class KMeansPP {
    public static void main(String[] args) throws IOException {
        String inputName = "train_img";
        String fileName = "RandomInit3";

        String resourcesPath = RandomInit.class.getClassLoader().getResource("train_img").getPath();
        String outputPath = resourcesPath.substring(0, resourcesPath.indexOf("/target/classes")) + "/src/main/resources/";
        fileName = outputPath + fileName;
        inputName = outputPath + inputName;

        String[] kmpp = new String[10];

        BufferedReader br = new BufferedReader(new FileReader(inputName));
        int index = (int)(Math.random() * 60000);
        for (int i = 0; i < index; i++) {
            String temp = br.readLine();
            if (i == index - 1) {
                kmpp[0] = temp;
            }
        }

        for (int i = 1; i < 10; i++) {
            br = new BufferedReader(new FileReader(inputName));
            String image;
            int maxDistance = Integer.MIN_VALUE;
            String maxString = "";
            while( (image = br.readLine() ) != null) {
                int value = getMin(image, kmpp, i);
                if (value > maxDistance) {
                    maxDistance = value;
                    maxString = image;
                }
            }

            kmpp[i] = maxString;
        }

        FileOutputStream fos = new FileOutputStream(fileName);
        StringBuilder sb = new StringBuilder();
        for (int i = 0; i < 10; i++) {
            sb.append(kmpp[i]).append("\n");
        }
        fos.write(sb.toString().getBytes());
    }

    private static int getMin(String image, String[] kmpp, int i) {
        int minDistance = Integer.MAX_VALUE;
        String pixels[] = image.split(",");

        for (int j = 0; j < i; j++) {
            int min = Integer.MAX_VALUE;
            String temp[] = kmpp[j].split(",");
            for (int k = 0; k < pixels.length; k++) {
                int distance = Math.abs(Integer.parseInt(pixels[k]) - Integer.parseInt(temp[k]));
                min += distance * distance;
            }
            if (min < minDistance) {
                minDistance = min;
            }
        }
        return minDistance;
    }
}

```

Then use K-Means in a and program in b to get the table result

```
Round <>: D(curr, prev) = <>
Round 1: D(curr, prev) = 5141.989109284461
Round 2: D(curr, prev) = 809.5949604586234
Round 3: D(curr, prev) = 862.4644920227151
Round 4: D(curr, prev) = 831.1648452623583
Round 5: D(curr, prev) = 1529.2102536930622
Round 6: D(curr, prev) = 1202.0524115029261
Round 7: D(curr, prev) = 1199.478219893967
Round 8: D(curr, prev) = 1206.2412693984566
Round 9: D(curr, prev) = 988.2180933377005
Round 10: D(curr, prev) = 998.3977163435421
Round 11: D(curr, prev) = 720.4109938083955
Round 12: D(curr, prev) = 485.69743668255035
Round 13: D(curr, prev) = 326.31426570102633
Round 14: D(curr, prev) = 249.0542109662071
Round 15: D(curr, prev) = 209.2008604188807
Round 16: D(curr, prev) = 181.55164554473197
Round 17: D(curr, prev) = 170.23219436992522
Round 18: D(curr, prev) = 163.59095329510126
Round 19: D(curr, prev) = 149.21461054467824
Round 20: D(curr, prev) = 128.67400669909986
Round 21: D(curr, prev) = 106.3296760081587
Round 22: D(curr, prev) = 100.23971268913334
Round 23: D(curr, prev) = 98.56469956328178
Round 24: D(curr, prev) = 95.98958276813167
Round 25: D(curr, prev) = 96.82458365518542
Round 26: D(curr, prev) = 83.65404951345751
Round 27: D(curr, prev) = 72.91090453423274
Round 28: D(curr, prev) = 67.7421582177598
Round 29: D(curr, prev) = 62.20128616033595
Round 30: D(curr, prev) = 60.0
Round 31: D(curr, prev) = 56.444663166680336
Round 32: D(curr, prev) = 55.4346462061408
Round 33: D(curr, prev) = 58.8387627334226
Round 34: D(curr, prev) = 60.63827174318213
Round 35: D(curr, prev) = 64.06246951218786
Round 36: D(curr, prev) = 66.48308055437865
Round 37: D(curr, prev) = 72.91776189653656
Round 38: D(curr, prev) = 75.70336848516055
Round 39: D(curr, prev) = 81.48619514985344
Round 40: D(curr, prev) = 81.47392220827471
Round 41: D(curr, prev) = 74.41102068914255
Round 42: D(curr, prev) = 72.85602240034794
Round 43: D(curr, prev) = 65.39113089708727
Round 44: D(curr, prev) = 57.01754116059373
Round 45: D(curr, prev) = 53.62835071116769
Round 46: D(curr, prev) = 55.21775076911409
Round 47: D(curr, prev) = 58.180752831155424
Round 48: D(curr, prev) = 62.08864630510155
Round 49: D(curr, prev) = 61.7980582219215
Round 50: D(curr, prev) = 60.91797764207213
Round 51: D(curr, prev) = 60.753600716336145
Round 52: D(curr, prev) = 57.5065213693195
Round 53: D(curr, prev) = 56.32051136131489
Round 54: D(curr, prev) = 49.82971001320397
Round 55: D(curr, prev) = 42.86023798347368
Round 56: D(curr, prev) = 38.52272056851645
Round 57: D(curr, prev) = 33.13608305156178
Round 58: D(curr, prev) = 30.903074280724887
Round 59: D(curr, prev) = 27.80287754891569
Round 60: D(curr, prev) = 26.70205984563738
Round 61: D(curr, prev) = 24.63736998950984
Round 62: D(curr, prev) = 21.517434791350013
Round 63: D(curr, prev) = 18.138357147217054
Round 64: D(curr, prev) = 18.601075237738275
Round 65: D(curr, prev) = 17.233687939614086
Round 66: D(curr, prev) = 16.522711641858304
Round 67: D(curr, prev) = 15.491933384829668
Round 68: D(curr, prev) = 15.937377450509228
Round 69: D(curr, prev) = 14.352700094407323
Round 70: D(curr, prev) = 13.228756555322953
Round 71: D(curr, prev) = 13.674794331177344
Round 72: D(curr, prev) = 11.832159566199232
Round 73: D(curr, prev) = 11.090536506409418
Round 74: D(curr, prev) = 11.269427669584644
Round 75: D(curr, prev) = 10.0
Round 76: D(curr, prev) = 8.717797887081348
Round 77: D(curr, prev) = 8.48528137423857
Round 78: D(curr, prev) = 7.615773105863909
Round 79: D(curr, prev) = 7.416198487095663
Round 80: D(curr, prev) = 6.782329983125268
Round 81: D(curr, prev) = 7.211102550927978
Round 82: D(curr, prev) = 7.14142842854285
Round 83: D(curr, prev) = 8.366600265340756
Round 84: D(curr, prev) = 8.94427190999916
Round 85: D(curr, prev) = 8.0
Round 86: D(curr, prev) = 6.855654600401044
Round 87: D(curr, prev) = 6.782329983125268
Round 88: D(curr, prev) = 4.898979485566356
Round 89: D(curr, prev) = 5.385164807134504
Round 90: D(curr, prev) = 3.7416573867739413
Round 91: D(curr, prev) = 3.3166247903554
Round 92: D(curr, prev) = 4.47213595499958
Round 93: D(curr, prev) = 5.291502622129181
Round 94: D(curr, prev) = 2.6457513110645907
Round 95: D(curr, prev) = 0.0
Achieve convergence at round = 95
```

The points are

```
Centroid 0: 7829, [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,2,2,2,2,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,7,13,21,33,45,55,62,63,57,46,33,22,14,8,5,3,1,0,0,0,0,0,0,0,0,1,6,14,27,48,75,106,138,161,173,172,161,139,109,75,48,29,17,9,4,2,0,0,0,0,0,0,1,5,13,29,54,88,127,165,191,199,199,197,192,182,156,117,77,46,26,13,7,3,1,0,0,0,0,0,1,7,19,40,70,105,141,163,165,153,141,138,146,155,149,124,85,49,25,12,5,2,0,0,0,0,0,0,2,8,19,39,66,96,118,122,106,83,71,74,94,117,127,113,80,44,21,9,3,1,0,0,0,0,0,0,1,6,16,32,54,78,91,87,67,47,42,55,81,106,117,103,71,37,17,6,2,0,0,0,0,0,0,0,1,4,11,24,43,64,78,76,64,54,59,79,104,119,116,93,59,29,12,5,1,0,0,0,0,0,0,0,0,2,8,19,36,59,80,90,93,99,112,128,141,139,119,84,50,24,9,3,1,0,0,0,0,0,0,0,0,1,5,16,33,60,90,118,138,153,166,173,173,160,129,89,55,27,10,3,1,0,0,0,0,0,0,0,0,1,4,13,29,58,95,130,157,175,182,183,178,165,142,111,75,41,18,6,2,0,0,0,0,0,0,0,0,0,3,9,23,48,81,111,133,146,151,151,149,148,144,131,103,65,32,12,4,1,0,0,0,0,0,0,0,0,2,6,15,32,55,76,89,96,96,94,97,110,128,138,126,89,48,21,7,1,0,0,0,0,0,0,0,1,2,5,11,22,36,47,54,55,50,46,50,67,100,134,139,108,63,30,11,2,0,0,0,0,0,0,1,2,5,8,13,21,31,38,40,37,28,20,22,38,79,128,145,118,73,37,14,3,0,0,0,0,0,0,1,5,9,15,22,30,38,43,40,31,19,11,11,29,76,131,151,123,78,41,16,4,0,0,0,0,0,0,2,7,16,25,36,47,56,57,48,34,19,13,19,46,98,149,159,122,77,39,14,3,0,0,0,0,0,0,3,9,21,35,53,72,85,87,75,57,44,43,59,96,144,174,159,112,65,30,11,2,0,0,0,0,0,0,3,9,20,39,64,93,118,131,129,118,111,117,137,165,187,178,137,86,45,19,6,1,0,0,0,0,0,0,2,7,16,33,58,92,129,160,180,189,191,194,200,199,180,139,90,50,23,9,2,0,0,0,0,0,0,0,1,3,8,19,35,61,93,129,162,186,196,192,176,148,110,70,39,18,7,2,0,0,0,0,0,0,0,0,0,1,2,6,11,20,33,48,66,80,87,83,70,52,33,18,8,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,2,3,4,4,5,5,4,3,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
Centroid 1: 5227, [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,2,3,3,3,3,3,4,5,4,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,6,8,10,17,32,51,54,46,33,19,9,4,1,0,0,0,0,0,0,0,0,0,0,1,2,3,4,6,8,10,15,30,66,101,107,85,58,32,16,8,3,1,0,0,0,0,0,0,0,0,0,1,2,4,5,8,10,13,20,46,95,135,136,103,66,37,21,12,6,2,0,0,0,0,0,0,0,0,0,2,3,4,7,10,13,18,30,69,126,161,149,106,65,39,25,18,12,5,1,0,0,0,0,0,0,0,1,2,3,5,8,11,16,25,46,99,158,180,150,98,58,38,28,23,16,7,1,0,0,0,0,0,0,0,1,1,2,4,7,12,22,38,72,134,183,184,136,81,47,31,25,20,14,6,1,0,0,0,0,0,0,0,0,1,2,4,8,17,34,56,102,165,194,168,104,54,29,20,16,12,8,3,0,0,0,0,0,0,0,0,0,1,2,6,14,29,48,74,132,183,187,133,65,28,14,9,7,5,3,1,0,0,0,0,0,0,0,0,0,1,3,11,25,41,58,96,163,193,171,93,34,13,6,4,3,2,1,0,0,0,0,0,0,0,0,0,0,2,7,18,34,49,72,136,192,199,140,56,19,9,5,3,2,1,0,0,0,0,0,0,0,0,0,0,1,4,10,23,38,56,103,179,210,186,97,34,15,9,6,4,3,2,0,0,0,0,0,0,0,0,0,1,3,6,12,23,39,70,141,202,208,148,61,26,16,9,6,4,3,2,1,0,0,0,0,0,0,0,0,3,7,9,14,24,46,96,172,207,185,101,41,23,14,8,5,3,2,1,1,0,0,0,0,0,0,0,1,6,13,15,19,33,66,130,189,197,144,65,32,19,11,5,3,2,2,1,1,0,0,0,0,0,0,0,1,8,19,23,29,51,97,160,195,175,105,48,27,15,7,4,3,2,2,1,1,0,0,0,0,0,0,0,1,9,23,34,48,81,133,184,192,146,77,38,20,11,6,4,3,2,2,1,0,0,0,0,0,0,0,0,1,9,23,41,67,111,163,194,174,114,55,27,15,10,7,5,4,2,1,1,0,0,0,0,0,0,0,0,1,7,21,42,77,125,168,180,141,80,35,18,11,8,6,5,3,2,1,0,0,0,0,0,0,0,0,0,1,6,18,40,76,118,152,148,105,50,20,10,7,5,4,3,2,1,0,0,0,0,0,0,0,0,0,0,1,5,14,32,60,92,113,103,63,25,9,4,3,2,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,2,6,12,20,30,37,33,20,8,3,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,5,6,5,4,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
Centroid 2: 6667, [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,4,3,2,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,2,3,5,5,5,4,4,6,10,14,16,14,10,4,1,0,0,0,0,0,0,0,0,1,3,5,8,12,18,25,33,40,46,52,55,54,50,43,35,26,17,8,2,0,0,0,0,0,0,1,3,7,12,20,30,44,62,84,105,116,120,123,126,129,123,100,72,45,26,12,4,1,0,0,0,0,1,3,7,14,26,40,60,91,127,159,171,165,152,145,151,168,169,143,99,58,29,13,5,1,0,0,0,0,1,4,10,20,35,56,90,135,174,186,168,139,117,112,133,169,180,152,102,56,24,10,3,0,0,0,0,0,1,5,11,20,37,67,111,156,173,149,107,74,61,73,117,168,180,143,87,41,15,5,2,0,0,0,0,0,1,4,9,18,39,78,127,154,137,88,47,29,32,66,132,183,174,122,63,26,8,2,0,0,0,0,0,0,0,2,7,18,46,89,129,134,97,49,26,24,43,102,172,195,156,91,40,14,4,1,0,0,0,0,0,0,0,1,6,21,52,93,121,113,78,50,43,51,88,158,205,188,124,61,24,9,3,1,0,0,0,0,0,0,0,1,8,26,55,88,106,102,87,78,78,94,146,204,213,160,88,40,17,8,3,1,0,0,0,0,0,0,0,1,10,27,50,74,89,93,94,94,99,129,190,223,191,117,56,26,13,7,3,1,0,0,0,0,0,0,0,1,9,22,38,53,63,70,74,79,99,159,217,212,144,70,30,14,8,5,2,0,0,0,0,0,0,0,0,1,6,13,21,28,33,37,43,60,113,195,223,169,85,31,12,6,3,1,0,0,0,0,0,0,0,0,0,1,3,6,10,12,14,18,31,71,156,220,196,110,38,10,3,1,1,0,0,0,0,0,0,0,0,0,0,0,2,4,6,7,9,19,48,115,199,215,145,57,14,3,1,1,0,0,0,0,0,0,0,0,0,0,0,0,2,4,6,8,15,38,86,164,215,177,88,23,5,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,4,8,14,31,67,129,195,195,124,43,9,3,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,4,10,24,52,100,161,195,154,76,20,5,2,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,5,16,37,72,122,170,169,112,43,10,3,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,8,22,46,82,125,150,128,70,23,5,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,8,21,42,69,97,103,75,34,9,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,4,10,20,30,39,40,26,9,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,2,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
Centroid 3: 5428, [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,6,12,20,28,33,36,34,28,20,12,6,2,0,0,0,0,0,0,0,0,0,0,0,0,1,1,3,7,16,29,47,67,83,87,81,67,47,27,13,5,1,0,0,0,0,0,0,0,0,0,0,0,1,2,6,13,27,49,77,103,118,117,102,78,50,27,12,5,1,0,0,0,0,0,0,0,0,0,0,1,2,4,9,20,42,74,106,128,133,121,94,63,35,17,7,3,1,0,0,0,0,0,0,0,0,0,0,1,3,5,13,32,64,102,131,142,131,102,69,39,19,8,4,2,1,1,0,0,0,0,0,0,0,0,0,1,3,7,21,49,90,127,148,143,113,76,43,21,10,5,3,2,2,1,0,0,0,0,0,0,0,0,0,1,4,11,32,71,117,149,154,129,86,49,25,14,9,5,3,2,2,1,0,0,0,0,0,0,0,0,1,2,5,17,48,97,142,164,147,101,57,29,17,14,12,8,4,3,2,1,0,0,0,0,0,0,0,0,1,2,7,26,69,124,164,166,124,70,36,22,21,23,22,17,10,6,3,1,0,0,0,0,0,0,0,0,0,3,11,40,94,151,177,151,94,49,33,36,44,50,49,38,23,12,5,2,0,0,0,0,0,0,0,0,0,4,18,57,120,173,178,128,73,51,58,75,90,97,92,73,47,24,9,3,0,0,0,0,0,0,0,0,0,6,27,78,144,184,165,108,73,80,105,127,141,142,132,106,71,39,16,5,1,0,0,0,0,0,0,0,1,10,40,97,162,186,150,101,94,118,144,157,159,158,152,130,90,51,22,7,1,0,0,0,0,0,0,0,2,16,51,112,171,181,141,110,119,142,150,141,135,143,153,141,102,59,26,9,2,0,0,0,0,0,0,0,4,21,61,121,173,177,143,125,132,136,122,103,104,131,157,147,104,59,25,9,3,0,0,0,0,0,0,0,6,24,64,123,172,181,158,137,130,118,98,89,109,149,168,142,93,49,20,7,2,0,0,0,0,0,0,1,6,23,60,115,169,192,181,155,136,122,113,125,154,178,166,120,70,33,13,5,1,0,0,0,0,0,0,0,5,17,47,97,154,196,204,189,172,163,166,180,190,175,133,82,42,18,7,2,1,0,0,0,0,0,0,0,2,9,28,64,118,172,206,216,214,209,204,194,170,128,80,42,18,7,3,1,0,0,0,0,0,0,0,0,1,3,10,29,62,107,150,180,192,186,167,136,98,60,32,14,6,2,1,0,0,0,0,0,0,0,0,0,0,0,2,5,13,29,48,65,75,75,63,46,29,15,7,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,4,6,9,9,8,6,4,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
Centroid 4: 4992, [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,4,4,4,3,2,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,4,7,15,26,40,52,63,67,62,51,37,23,12,4,1,0,0,0,0,0,0,0,0,0,0,1,2,5,13,26,46,72,102,127,144,151,143,123,95,63,35,15,4,0,0,0,0,0,0,0,0,0,0,2,5,14,30,56,90,125,157,178,191,194,192,179,150,112,70,34,11,1,0,0,0,0,0,0,0,0,1,4,12,29,58,96,134,165,182,191,192,191,194,193,181,152,108,62,23,4,0,0,0,0,0,0,0,0,2,8,24,53,93,134,166,180,178,168,158,152,154,167,180,176,142,91,40,8,0,0,0,0,0,0,0,0,3,16,43,83,129,165,178,170,150,127,109,98,99,119,153,177,166,120,58,13,0,0,0,0,0,0,0,1,8,29,67,116,159,178,169,141,109,82,61,51,53,75,119,165,178,142,77,20,0,0,0,0,0,0,0,2,15,47,98,148,179,174,142,102,69,45,31,26,29,47,93,151,182,156,93,27,0,0,0,0,0,0,0,3,26,71,129,174,183,153,105,63,37,22,16,15,18,34,78,141,182,163,103,32,0,0,0,0,0,0,0,6,41,98,157,188,171,121,68,33,18,12,10,10,13,30,74,139,182,163,105,35,1,0,0,0,0,0,0,10,60,123,178,189,147,87,38,16,9,8,7,8,13,35,83,145,182,158,100,35,1,0,0,0,0,0,0,16,79,146,189,179,121,58,20,9,6,6,6,8,19,49,102,157,178,146,88,30,1,0,0,0,0,0,0,22,95,161,193,165,99,39,12,6,5,6,8,16,37,77,129,169,168,126,71,22,0,0,0,0,0,0,0,28,105,168,191,156,89,34,12,8,8,12,20,38,71,115,157,174,149,101,50,14,0,0,0,0,0,0,0,31,105,167,190,159,98,47,24,19,23,33,51,79,116,152,173,160,120,72,31,7,0,0,0,0,0,0,0,29,95,157,189,174,129,84,59,55,62,78,102,131,159,174,163,129,85,44,15,2,0,0,0,0,0,0,0,22,74,135,180,192,174,145,125,119,125,139,158,173,177,163,130,89,50,21,6,0,0,0,0,0,0,0,0,12,48,100,153,190,204,200,190,185,185,188,188,178,156,122,83,48,22,7,1,0,0,0,0,0,0,0,0,5,23,58,102,147,181,200,204,202,196,183,162,134,99,66,37,17,6,1,0,0,0,0,0,0,0,0,0,1,6,19,43,74,106,130,144,145,133,114,88,62,39,21,9,3,1,0,0,0,0,0,0,0,0,0,0,0,0,2,6,12,21,29,35,36,33,27,19,12,6,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
Centroid 5: 4676, [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,2,3,3,4,4,3,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,6,11,18,27,37,45,50,51,46,36,25,16,9,4,1,0,0,0,0,0,0,0,0,0,0,1,3,9,19,34,54,78,102,122,133,134,125,104,78,54,31,15,5,1,0,0,0,0,0,0,0,0,0,3,9,21,40,64,92,122,148,166,178,180,172,154,123,89,57,30,12,2,0,0,0,0,0,0,0,0,1,6,15,33,56,83,111,135,149,158,164,170,171,165,146,114,78,45,19,4,0,0,0,0,0,0,0,0,2,8,19,38,59,82,101,113,117,116,117,124,137,149,147,126,92,56,26,6,0,0,0,0,0,0,0,0,2,8,20,35,51,65,75,78,76,71,71,80,103,129,142,130,99,61,29,7,0,0,0,0,0,0,0,0,1,6,16,27,37,43,47,47,42,38,39,53,82,119,142,135,102,62,29,7,0,0,0,0,0,0,0,0,1,4,11,17,22,25,26,24,21,21,27,46,81,123,146,137,100,57,25,6,0,0,0,0,0,0,0,0,0,3,7,10,12,13,14,14,14,19,30,54,92,133,152,135,93,49,20,5,0,0,0,0,0,0,0,0,0,2,5,6,8,9,11,14,19,28,44,72,109,145,154,127,80,38,15,4,1,0,0,0,0,0,0,0,0,3,6,9,12,16,23,30,40,52,70,96,130,155,149,112,64,28,11,5,2,0,0,0,0,0,0,0,1,5,12,21,30,42,55,67,79,93,109,131,152,159,138,95,51,22,9,6,4,1,0,0,0,0,0,1,4,14,29,47,65,83,100,114,127,139,153,164,167,157,125,83,47,24,15,11,6,2,0,0,0,0,0,2,11,30,57,83,106,124,135,145,157,169,178,182,174,152,119,82,53,34,25,19,11,4,0,0,0,0,0,5,22,51,87,116,134,141,144,152,164,177,186,185,173,151,124,95,71,54,41,29,17,7,1,0,0,0,0,9,34,71,111,139,150,152,154,158,170,182,187,184,172,156,137,116,96,79,61,42,24,9,0,0,0,0,0,12,41,83,126,158,173,176,176,178,183,184,180,171,159,149,140,127,112,93,71,48,25,8,1,0,0,0,0,12,41,81,127,164,189,198,195,189,180,166,149,133,124,120,120,114,103,85,63,41,21,6,0,0,0,0,0,9,31,64,105,143,169,180,174,159,139,117,97,82,76,77,81,80,74,60,43,27,13,3,0,0,0,0,0,4,16,36,62,90,109,116,109,94,74,56,42,35,34,37,41,43,40,33,23,14,6,1,0,0,0,0,0,1,4,10,19,28,35,35,31,24,17,12,8,7,8,10,12,13,13,11,8,4,1,0,0,0,0,0,0,0,0,1,1,2,2,1,1,1,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
Centroid 6: 5412, [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,2,2,3,4,4,5,6,5,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,5,8,15,27,44,58,61,45,23,8,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,5,9,15,28,53,88,117,123,89,42,11,3,1,0,0,0,0,0,0,0,0,0,0,0,0,1,2,5,8,13,21,37,67,112,153,158,112,51,14,4,2,1,0,0,0,0,0,0,0,0,0,0,0,1,3,7,11,15,23,39,70,121,170,173,118,51,14,4,2,1,0,0,0,0,0,0,0,0,0,0,0,1,4,6,9,13,19,33,64,120,176,176,115,47,13,4,1,1,0,0,0,0,0,0,0,0,0,0,0,1,3,4,6,9,14,27,58,121,181,176,109,40,11,3,1,1,0,0,0,0,0,0,0,0,0,0,0,1,2,2,4,6,12,23,56,127,188,178,102,33,8,2,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,2,5,11,23,59,137,198,181,93,25,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,5,12,25,62,148,207,183,83,19,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,4,12,27,65,159,214,182,74,16,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,4,11,28,67,166,217,178,70,18,6,3,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,5,12,29,71,170,217,173,68,22,9,4,2,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,3,6,13,30,76,169,212,164,69,28,13,5,3,2,1,1,0,0,0,0,0,0,0,0,0,0,0,1,3,6,14,33,82,166,202,152,70,33,17,7,4,3,3,2,2,1,0,0,0,0,0,0,0,0,0,1,2,6,16,35,87,163,192,142,73,36,18,8,5,4,4,3,2,0,0,0,0,0,0,0,0,0,0,1,3,7,16,39,93,161,184,137,77,38,18,8,6,5,4,3,2,0,0,0,0,0,0,0,0,0,0,2,4,8,18,45,100,163,180,137,81,39,19,10,7,5,3,2,1,0,0,0,0,0,0,0,0,0,0,2,5,9,20,52,107,165,176,135,81,38,18,9,6,4,2,1,0,0,0,0,0,0,0,0,0,0,0,1,4,9,20,52,105,154,161,123,73,34,15,7,5,3,1,0,0,0,0,0,0,0,0,0,0,0,0,1,3,5,14,38,81,118,120,91,53,23,8,4,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,5,13,28,43,42,30,16,6,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,6,9,7,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
Centroid 7: 5444, [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,4,5,4,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,6,9,10,8,5,3,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,7,13,16,16,12,8,5,3,4,4,5,5,4,3,2,1,0,0,0,0,0,0,0,0,0,2,5,10,18,27,32,29,23,16,13,12,16,19,20,17,14,10,7,4,1,0,0,0,0,0,0,0,1,5,11,22,36,54,63,61,56,50,47,45,45,46,44,36,27,19,13,8,3,0,0,0,0,0,0,1,4,10,22,41,69,96,106,101,91,84,78,77,77,77,71,58,43,29,19,10,3,0,0,0,0,0,1,3,8,18,37,69,110,138,136,116,95,84,79,83,92,100,98,82,59,38,22,10,3,0,0,0,0,0,2,5,12,27,55,100,145,160,134,98,74,62,59,69,90,113,121,105,75,45,23,9,2,0,0,0,0,0,2,6,15,36,74,126,164,154,108,68,47,38,39,54,85,121,138,125,88,51,25,8,2,0,0,0,0,0,2,5,17,43,89,143,165,133,78,42,28,24,29,48,85,128,151,138,95,54,27,11,3,0,0,0,0,0,1,5,18,48,100,151,160,116,60,30,21,22,32,55,95,140,162,142,95,54,29,15,6,1,0,0,0,0,0,4,18,51,107,156,159,114,65,42,36,42,55,79,114,155,169,142,93,53,31,19,10,2,0,0,0,0,0,3,17,51,107,155,165,132,95,77,76,84,98,116,140,169,175,141,91,54,34,23,12,3,0,0,0,0,0,3,14,46,97,144,164,152,133,122,122,129,137,143,154,178,180,139,88,54,37,25,14,4,0,0,0,0,0,2,10,36,75,115,143,149,144,140,138,139,138,135,149,178,181,133,83,52,36,24,13,4,0,0,0,0,0,1,6,23,49,77,101,115,117,114,109,105,100,101,130,172,176,124,75,47,32,20,10,3,0,0,0,0,0,0,3,12,25,41,56,69,74,72,68,63,62,72,116,167,167,113,67,41,26,15,6,1,0,0,0,0,0,0,1,5,10,17,25,34,40,42,41,41,44,62,112,161,156,106,62,36,21,10,4,0,0,0,0,0,0,0,0,1,3,5,9,14,20,25,28,32,40,62,112,155,147,98,56,30,16,7,2,0,0,0,0,0,0,0,0,0,1,2,3,6,9,13,17,24,36,60,106,143,132,89,50,25,13,5,1,0,0,0,0,0,0,0,0,0,0,1,2,3,4,6,10,17,29,53,94,126,117,81,47,24,11,5,1,0,0,0,0,0,0,0,0,0,0,0,1,2,3,5,9,16,28,50,85,110,102,73,44,22,10,4,1,0,0,0,0,0,0,0,0,0,0,0,1,1,2,4,7,13,23,41,65,82,77,55,33,16,7,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,3,7,13,23,36,45,42,29,16,8,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,4,9,13,15,13,9,5,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,2,2,1,0,0,0,0,0,0,0,0,0]
Centroid 8: 7162, [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,3,6,12,21,31,38,41,38,31,23,16,11,6,3,1,0,0,0,0,0,0,0,0,0,0,0,2,7,17,36,64,94,121,137,142,132,112,84,59,38,24,12,3,0,0,0,0,0,0,0,0,0,0,2,8,23,53,94,137,169,186,194,195,189,169,136,99,65,41,21,7,1,0,0,0,0,0,0,0,0,2,7,22,52,99,147,180,190,186,178,177,180,175,152,114,76,47,25,9,1,0,0,0,0,0,0,0,1,4,14,39,81,132,168,174,155,132,120,124,142,153,139,106,69,40,20,7,1,0,0,0,0,0,0,0,2,7,21,53,100,144,160,138,103,78,75,91,119,133,119,85,52,28,13,4,0,0,0,0,0,0,0,0,2,9,26,61,110,148,145,109,73,58,67,94,120,123,100,64,34,16,7,2,0,0,0,0,0,0,0,0,2,9,28,67,119,152,143,106,78,75,94,117,126,110,77,42,19,8,3,0,0,0,0,0,0,0,0,0,2,10,31,72,125,159,157,132,113,117,131,134,117,86,51,23,9,3,1,0,0,0,0,0,0,0,0,0,2,10,31,75,125,162,175,167,157,158,153,132,98,62,32,12,4,1,0,0,0,0,0,0,0,0,0,0,2,9,31,71,115,151,173,179,177,171,151,118,84,50,23,7,1,0,0,0,0,0,0,0,0,0,0,0,3,10,30,64,99,130,153,162,163,155,137,113,85,50,20,4,0,0,0,0,0,0,0,0,0,0,1,2,5,14,35,63,92,115,127,128,129,131,131,123,95,52,17,3,0,0,0,0,0,0,0,0,0,1,3,6,12,25,48,75,95,103,97,88,95,117,139,140,104,50,13,2,0,0,0,0,0,0,0,0,0,2,7,14,25,44,69,92,99,88,67,57,78,122,159,154,103,42,9,1,0,0,0,0,0,0,0,0,1,4,11,25,44,69,94,108,100,74,52,55,93,147,178,153,89,30,6,1,0,0,0,0,0,0,0,0,1,5,14,32,61,95,122,130,114,88,77,96,139,180,180,131,64,19,4,1,0,0,0,0,0,0,0,0,0,5,13,33,68,110,144,158,154,142,141,160,183,186,152,91,38,11,2,0,0,0,0,0,0,0,0,0,0,3,10,26,58,101,145,176,192,196,198,197,185,151,99,50,18,5,1,0,0,0,0,0,0,0,0,0,0,1,5,14,35,69,109,148,176,189,183,163,127,85,47,20,7,2,0,0,0,0,0,0,0,0,0,0,0,0,1,4,12,25,44,66,84,92,87,70,49,27,12,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,5,6,6,5,4,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
Centroid 9: 7163, [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,4,6,9,10,10,10,11,12,12,10,7,3,1,0,0,0,0,0,0,0,0,0,0,1,3,5,8,14,22,34,46,57,63,65,62,53,41,27,16,8,4,2,1,0,0,0,0,0,0,1,3,8,14,21,31,47,70,98,119,129,131,132,131,119,91,58,30,14,7,4,2,1,0,0,0,0,1,4,9,18,28,42,62,93,133,163,170,159,149,149,159,162,135,87,45,20,8,4,2,1,0,0,0,0,2,6,13,23,36,55,84,129,168,177,154,124,109,117,146,170,153,103,52,22,8,3,2,1,0,0,0,0,2,5,11,20,33,55,94,142,164,141,99,68,59,79,128,168,156,105,51,20,7,2,0,0,0,0,0,0,1,4,7,13,25,52,98,140,140,96,51,31,33,64,126,172,156,99,46,16,5,1,0,0,0,0,0,0,0,2,4,8,19,49,100,136,120,70,34,25,37,78,145,182,151,88,37,13,4,0,0,0,0,0,0,0,0,0,2,6,17,48,98,131,113,72,50,49,66,109,169,191,143,77,30,11,3,1,0,0,0,0,0,0,0,0,1,5,16,45,90,121,116,95,86,88,100,137,188,195,134,66,27,11,5,2,0,0,0,0,0,0,0,0,1,4,14,36,72,103,112,109,108,109,115,151,201,194,121,55,22,10,5,2,1,0,0,0,0,0,0,0,0,3,10,24,47,72,86,91,93,93,105,158,210,184,99,39,15,7,4,2,0,0,0,0,0,0,0,0,0,2,6,13,23,36,46,51,54,57,88,167,216,165,72,22,8,4,2,1,0,0,0,0,0,0,0,0,0,1,2,5,9,13,18,21,24,33,88,180,211,139,48,11,3,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,2,4,6,8,11,30,107,193,196,112,32,6,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,5,10,47,132,199,174,88,23,5,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,3,5,17,74,154,194,149,71,19,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,8,34,101,168,181,127,60,17,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,3,5,16,56,120,168,160,108,52,16,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,4,8,25,68,120,146,127,85,42,14,4,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,8,24,59,91,97,79,52,26,9,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,11,27,40,39,29,18,9,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,4,4,3,1,0,0,0,0,0,0,0,0,0,0,0]

```

Form the table

<p align=center><strong>Table 6. The Accuracy of Clustering Performance with K-means++</strong></p>

| Cluster Index | Major Label of the cluster | # Train images belonging to the cluster | # Correctly clustered images | Classification Accuracy (%) |
| :-----------: | :------------------------: | :-------------------------------------: | :--------------------------: | :-------------------------: |
|       0       |             3              |                  7829                   |             3899             |            49.80            |
|       1       |             1              |                  5227                   |             2988             |            57.16            |
|       2       |             7              |                  6667                   |             2801             |            42.01            |
|       3       |             6              |                  5428                   |             4639             |            85.46            |
|       4       |             0              |                  4992                   |             4688             |            93.91            |
|       5       |             2              |                  4676                   |             4209             |            90.01            |
|       6       |             1              |                  5412                   |             3699             |            68.35            |
|       7       |             4              |                  5444                   |             2212             |            40.63            |
|       8       |             8              |                  7162                   |             3135             |            43.77            |
|       9       |             9              |                  7163                   |             2450             |            34.20            |
|   Total Set   |            N/A             |                  60000                  |            34720             |            57.87            |

Compared to other initialization methods, there is not much difference in the overall achievable recognition accuracy. However, it provides a more stable convergence process, ensuring that the number of iterations does not become too large (for example, one of the provided seeds iterated over 150 times before stopping).

Delete result and exit

```bash
hadoop fs -rm -r /user
hadoop fs -rm -r /tmp
../sbin/stop-yarn.sh
../sbin/stop-dfs.sh
```

##  Q3 [20 marks]

### a. [bonus 20 marks]

#### Initialization

1. Input: $X$, $K$, $Max$, $Threshold$
2. Randomly initialize:
    - $\pi_k$ where $\sum_{k=1}^{K} \pi_{k}=1$.
    - For each cluster $k$,  $\theta_k \in (0,1)$.
3. $\text{Log-Likelihood} = -\infty$.

#### EM Algorithm

For iteration = 1 to Max:

	1. E-step (Expectation Step):

    For data point $i$, cluster $k$

    ​	$i, k \in \mathbb{Z}^{+}, i \in [1, N], k \in [1, K]$

    ​	$\gamma_k = \frac{\pi_k P(X_i|\theta_k)}{\sum_{j=1}^K \pi_j P(X_i|\theta_j)}$ ,where $P(\mathbf{x}_i | \theta_k) = \prod_{d=1}^D \theta_{kd}^{x_{id}} (1 - \theta_{kd})^{1 - x_{id}}$

    ​	Normalize $\gamma_{ik}$ so that $\sum_{k=1}^K \gamma_{ik} = 1$

	2. M-step (Maximization Step):

    Update $\pi_k$ :  $\pi_k = \frac{\sum_{i=1}^N \gamma_{ik}}{N}$
    Update $ \theta_k$ : For $k, d \in \mathbb{Z}^{+}, k \in [1, K], d \in [1, D]$

    ​	$\theta_{kd} = \frac{\sum_{i=1}^N \gamma_{ik} \cdot x_{id}}{\sum_{i=1}^N \gamma_{ik}}$

	3. Log-Likelihood Calculation:

    $\text{Log-Likelihood} = \sum_{i=1}^N \log \left( \sum_{k=1}^K \pi_k \cdot P(\mathbf{x}_i | \theta_k) \right)$

	4. Convergence Check:

​	if ($| \text{Log-Likelihood}_{New} - \text{Log-Likelihood}_{Old} | < Threshold$) { break;}

#### Output

​	$\pi_k, \theta_k$ for cluster $k$ .

## References

<ol>
    <li>https://mobitec.ie.cuhk.edu.hk/iems5709Fall2024/</li>
    <li>https://www.geogebra.org/graphing</li>
</ol>
